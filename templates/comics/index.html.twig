{% extends 'base.html.twig' %}

{% block body %}
    <input type="text" id="search-bar" placeholder="Rechercher un comic..."/>

    <div class="comic-list" id="comic-list">
        {% include 'comics/_list.html.twig' with { comics: comics } %}
    </div>
    <script>
        const searchInput = document.getElementById('search-bar');
        const comicList = document.getElementById('comic-list');

        searchInput.addEventListener('input', function () {
            const query = searchInput.value.trim();

            if (query === '') {
                // Revenir à la liste initiale sans faire de fetch
                comicList.innerHTML = `{% include 'comics/_list.html.twig' with { comics: comics } %}`;
                return;
            }

            fetch(`/comics/search?title=${encodeURIComponent(query)}`)
                .then(res => res.text())
                .then(html => {
                    comicList.innerHTML = html;
                })
                .catch(err => {
                    console.error(err);
                    comicList.innerHTML = '<p>Erreur lors de la récupération des comics.</p>';
                });
        });
    </script>

{% endblock %}
